<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>


<!--####################################### External layout factura HIELOS ##################################-->

  <template id="external_layout_facturas_hielos">
    <!-- Multicompany -->
    <t t-if="o and 'company_id' in o">
        <t t-set="company" t-value="o.company_id"></t>
    </t>
    <t t-if="not o or not 'company_id' in o">
        <t t-set="company" t-value="res_company"></t>
    </t>

    <t t-call="liderit_hielos_reports.layout_header_factura_hielos" />
    <t t-raw="0" />
    <t t-call="liderit_hielos_reports.layout_footer_factura_hielos" />
</template>





  <!--####################################### Estrutura Nuevo HEADER HIELOS ##################################-->
      
    <template id="layout_header_factura_hielos">   
              <div class="header" style="font-size:11px !important;">
                    <div class="col-xs-3 text-center" style="width:35%;float:left;">
                       <img t-if="o.company_id.logo" t-att-src="'data:image/png;base64,%s' % o.company_id.logo" style="max-height: 45px;"/><br/>
                      <span style="font-size:1.3em;" t-field="o.company_id.name"/><br/>
                      <span t-field="o.company_id.street"/><br/>
                      <span t-field="o.company_id.zip"/><span t-field="o.company_id.city"/><br/>
                      <span>(<span t-field="o.company_id.state_id"/>)</span><br/>
                      <span>Tfno: <span t-field="o.company_id.phone"/></span><br/>
                      <span>Email: <span t-field="o.company_id.email"/></span><br/>
                      <span t-field="o.company_id.website"/><br/>
                      <span>C.I.F. : <span t-field="o.company_id.vat"/></span>
                      <br/>
                      <br/>
                    </div>

                    <div class="row" >
                        <div style="width:45%;float:right;border:1px solid black;border-radius:15px;padding:10px;margin-top:30px;">
                        <span t-field="o.partner_id.name"/><br/>
                        <span style="font-weight:bold;"  t-field="o.partner_id.street"/><br/>
                        <span style="font-weight:bold;"  t-field="o.partner_id.zip"/><span style="font-weight:bold;margin-left:20px" t-field="o.partner_id.city"/><br/>
                        <div><span style="font-weight:bold;" t-field="o.partner_id.state_id"/><span style="margin-left:20px;font-weight:bold;" t-field="o.partner_id.vat"/></div>
                       </div>
                    </div>

                     <div style="width:45%;float:left;"> 
                  <table class="table table-bordered" >
                          <thead class="text-uppercase" style="background-color:gray;border:1px solid black">
                            <tr>
                              <th>cliente</th>
                              <th>fecha</th>
                              <th>factura</th>
                              <th>pág</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td><span t-field="o.partner_id.ref"/></td>
                              <td><span t-field="o.date_invoice"/></td>
                              <td><span t-field="o.number"/></td>
                              <td><span class="page"></span></td>
                            </tr>
                          </tbody>
                    </table>  
                </div>

                <t t-if="o.origin_invoices_ids">
                  
                  <div style="width:45%; float:right;"> 
                  <table class="table table-bordered" >
                          <thead class="text-uppercase" style="background-color:gray;border:1px solid black">
                            <tr>
                              <th t-att-colspan="2" class="text-center">Facturas Rectificadas</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr t-foreach="o.origin_invoices_ids" t-as="h">
                              <td><strong>Nùmero: </strong><span t-field="h.number"/></td>
                              <td><strong>Fecha: </strong><span t-field="h.date_invoice"></span></td>
                            </tr>
                          </tbody>
                    </table>  
                </div>
                </t>
          </div>
    </template>

    <!--#####################################################################################-->





    <!--####################################### Estrutura Nuevo FOOTER HIELOS ##################################-->


    <template id="layout_footer_factura_hielos">
        
        <xpath expr="//div[@class='footer']" position="replace">
            <div class="footer" style="font-size:10px !important;">
                
                <div class="row" style="border-top: 1px solid black;padding-top:5px;">
                    <p><span t-field="o.company_id.company_registry"/>,<span t-field="o.company_id.vat"/>. <span style="font-weight:bold;">Según lo dispuesto en la LOPD, le informamos que sus datos de caracter personal recogidos serán tratados con estricta confidencialidad y se almacenarán en un fichero de datos de caracter personal, legalmente registrado en la AEPD, y cuya finalidad es la gestión comercial entre los clientes y Hielos de Cantabria S.L.</span></p>
                </div>
             </div>

        </xpath>

    </template>

    <!--#########################################################################-->





    <!--##################################### Estrutura FACTURA HIELOS ####################################-->
		  <!-- QWeb Report -->
        <template id="liderit_hielos_invoice_report_document">
          <t t-call="liderit_hielos_reports.external_layout_facturas_hielos">

          <div class="page" style="font-size:11px !important;">
            <div class="oe_structure">
             
                
                <table class="table table-condensed" style="">
                    <thead class="text-uppercase" style="background-color:gray;border:1px solid black">
                        <tr>
                            <th>código</th>
                            <th>descripción</th>
                            <th></th>
                            <th>caja</th>
                            <th>unidades</th>
                            <th>importe</th>
                        </tr>
                    </thead>
                    <tbody class="invoice_tbody">
                       <tr t-foreach="o.invoice_line" t-as="l">
                            <td><span t-field="l.product_id.default_code"/></td>
                           <td>
                                <span t-field="l.name"/>
                            </td>
                             <td>
                             
                            </td>
                            <td class="text-right">
                            	 <span t-esc="int(l.quantity)"/>
                            </td>
                            <td class="text-right">
                               <span t-esc="l.quantity*l.product_id.packaging_ids.qty"/>
                            </td>
                            <td class="text-right"><span t-field="l.price_subtotal"/></td>
                            
                        </tr>
                    </tbody>
                </table>

                <div class="row " style="margin-top:100px;">
                  <table class="table table-bordered">
                    <thead class="text-uppercase" style="background-color:gray;">
                      <th>total imp</th>
                      <th>%</th>
                      <th>importe</th>
                      <th>base</th>
                      <th>%</th>
                      <th>iva</th>
                      <th>%</th>
                      <th>rec</th>
                      <th>total fra</th>
                    </thead>
                    <tbody class="text-right">

                          <t t-set="i" t-value="1"/>
                          <t t-foreach="o.tax_line" t-as="p" >
                            <t t-set="i" t-value="i+1"/>
                          </t>
  
                      <t t-set="z" t-value="1"/>
                      
                      <t t-foreach="o.tax_line" t-as="t">
                            

                        <t t-if="'Recargo Equivalencia' not in t.name ">
                          
                        <tr>
                        <t t-if="z == 1">
                        <td  t-att-rowspan="i"><span t-field="o.amount_untaxed"/></td>
                        </t>
                        <td></td>
                        <td></td>


                        <td>
                          <t t-if="'Recargo Equivalencia' not in t.name ">
                          <span t-field="t.base"/>
                          </t>
                        </td>

                        <t t-set="h" t-value="t.amount"/>
                        <t t-set="j" t-value="t.base_amount"/>
                        <t t-set="k" t-value="h*100/j"/>

                        <td>
                           <t t-if="'Recargo Equivalencia' not in t.name ">
                            <span t-esc="round(k)"/>
                           </t>
                        </td>

                        <td>
                           <t t-if="'Recargo Equivalencia' not in t.name ">
                          <span t-field="t.amount"/>
                          </t>
                        </td>

                        <td>
                          <t t-if="'21% IVA' == t.name" >
                            <t t-foreach="o.tax_line" t-as="b">
                                <t t-if="'5.2% Recargo Equivalencia Ventas' == b.name ">
                                 <span>5,2</span>
                           </t>
                          </t>
                        </t>
                          <t t-if="'10% IVA' == t.name" >
                            <t t-foreach="o.tax_line" t-as="b">
                                <t t-if="'1.4% Recargo Equivalencia Ventas' == b.name ">
                                 <span>1,4</span>
                           </t>
                          </t>
                        </t>
                          <t t-if="'4% IVA' == t.name" >
                            <t t-foreach="o.tax_line" t-as="b">
                                <t t-if="'0.50% Recargo Equivalencia Ventas' == b.name ">
                                  <span>0,5</span>
                           </t>
                          </t>
                        </t>

                        </td>
                        
                          <td>
                            <t t-if="'21% IVA' == t.name">
                            <t t-foreach="o.tax_line" t-as="b">
                                <t t-if="'5.2% Recargo Equivalencia Ventas' == b.name ">
                                  <span t-field="b.amount"/>
                             </t>
                           </t>
                          </t>
                          <t t-if="'10% IVA' == t.name">
                            <t t-foreach="o.tax_line" t-as="b">
                                <t t-if="'1.4% Recargo Equivalencia Ventas' == b.name ">                      
                                  <span t-field="b.amount"/>
                             </t>
                           </t>
                          </t>
                          <t t-if="'4% IVA' == t.name">
                            <t t-foreach="o.tax_line" t-as="b">
                                <t t-if="'0.50% Recargo Equivalencia Ventas' == b.name ">                           
                                  <span t-field="b.amount"/>
                             </t>
                           </t>
                          </t>
                          </td>
                        
                        
                        <t t-if="z == 1">
                        <td  t-att-rowspan="i"><span t-field="o.amount_total"/></td>
                        </t>
                        <t t-set="z" t-value="z+1"/>
                      </tr>

                      
                    </t>
                    </t>
                    
                    </tbody>
                  </table>
              </div>


              <div class="row" style="margin-top:5px;">
                  <div style="width:45%;float:left;border:1px solid black;border-radius:15px;padding:10px;">
                    <p>Forma de Pago: <span style="font-weight:bold;" t-field="o.payment_mode_id"/></p>
                    <p>Banco:
                      <t t-if=" 'Manual' not in  o.payment_mode_id.type.name">
                     <span style="font-weight:bold;" t-field="o.partner_id.bank_ids.acc_number"/>
                    </t>

                    <t t-if=" 'Manual' in  o.payment_mode_id.type.name">
                     <span style="font-weight:bold;" t-field="o.partner_bank_id"/>
                    </t>
                   </p>
                  </div>

                  <div style="padding:10px;float:left; margin-left:20px;width:45%;border:1px solid black;border-radius:15px;">
                    <p>Vencimientos:</p>
                    <p t-foreach="o.due_lines" t-as="x">
                     <p> <span t-field="x.date_maturity"/><span style="font-weight:bold;margin-left:10px;" t-field="x.debit"/></p>
                    </p>
                  </div>
              </div>

              </div>
           </div>
      </t>
            <!--end of report structure-->
        </template>
<!--####################################################################################################-->
        <template id="liderit_hielos_invoice_report">
            <t t-call="report.html_container">
                <t t-foreach="docs" t-as="o">

                    <t t-call="liderit_hielos_reports.liderit_hielos_invoice_report_document" t-lang="o.partner_id.lang"/>
                </t>
   
            </t>
        </template>












<!-- ############################## External layout Albaran Hielos ##################################-->

  <template id="external_layout_albaranes_hielos">
    <!-- Multicompany -->
    <t t-if="o and 'company_id' in o">
        <t t-set="company" t-value="o.company_id"></t>
    </t>
    <t t-if="not o or not 'company_id' in o">
        <t t-set="company" t-value="res_company"></t>
    </t>

    <t t-call="liderit_hielos_reports.layout_header_picking_hielos" />
    <t t-raw="0" />
    <t t-call="liderit_hielos_reports.layout_footer_factura_hielos" />
</template>








<!-- ############################## Header Albaran Hielos ##################################-->

<template id="layout_header_picking_hielos">   
              <div class="header" style="font-size:11px !important;">
                    <div class="col-xs-3 text-center" style="width:35%;float:left;">
                       <img t-if="o.company_id.logo" t-att-src="'data:image/png;base64,%s' % o.company_id.logo" style="max-height: 45px;"/><br/>
                      <span style="font-size:1.3em;" t-field="o.company_id.name"/><br/>
                      <span t-field="o.company_id.street"/><br/>
                      <span t-field="o.company_id.zip"/><span t-field="o.company_id.city"/><br/>
                      <span>(<span t-field="o.company_id.state_id"/>)</span><br/>
                      <span>Tfno: <span t-field="o.company_id.phone"/></span><br/>
                      <span>Email: <span t-field="o.company_id.email"/></span><br/>
                      <span t-field="o.company_id.website"/><br/>
                      <span>C.I.F. : <span t-field="o.company_id.vat"/></span>
                      <br/>
                      <br/>
                    </div>

                    <div class="row" >
                        <div style="width:45%;float:right;border:1px solid black;border-radius:15px;padding:10px;margin-top:30px;">
                        <span t-field="o.partner_id.name"/><br/>
                        <span style="font-weight:bold;"  t-field="o.partner_id.street"/><br/>
                        <span style="font-weight:bold;"  t-field="o.partner_id.zip"/><span style="font-weight:bold;margin-left:20px" t-field="o.partner_id.city"/><br/>
                        <div><span style="font-weight:bold;" t-field="o.partner_id.state_id"/><span style="margin-left:20px;font-weight:bold;" t-field="o.partner_id.vat"/></div>
                       </div>
                    </div>

                     <div style="width:auto;"> 
                  <table class="table table-bordered" >
                          <thead class="text-uppercase" style="background-color:gray;border:1px solid black">
                            <tr>
                              <th>fecha</th>
                              <th>albarán</th>
                              <th>cliente</th>
                              <th>n.i.f</th>
                              <th>teléfono</th>
                              <th>ruta</th>
                              <th>pág</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td><span t-field="o.date"/></td>
                              <td><span t-field="o.name"/></td>
                              <td><span t-field="o.partner_id.ref"/></td>
                              <td><span t-field="o.partner_id.vat"></span></td>
                              <td><span t-field="o.partner_id.phone"></span></td>
                              <td><span t-field="o.partner_id.tercap_reparto_id"></span></td>
                              <td><span class="page"></span></td>
                            </tr>
                          </tbody>
                    </table>  
                </div>
          </div>
    </template>
<!--####################################################################################################-->







<!-- ############################## cuerpo Albaran Hielos ##################################-->
        

        <template id="liderit_hielos_picking_report_document">
          <t t-call="liderit_hielos_reports.external_layout_albaranes_hielos">

          <div class="page" style="font-size:11px !important;">
            <div class="oe_structure">
             
                
                <table class="table table-condensed" style="">
                    <thead class="text-uppercase" style="background-color:gray;border:1px solid black">
                        <tr>
                            <th>código</th>
                            <th t-att-colspan="2">descripción</th>
                            <th>cajas</th>
                            <th>unidades</th>
                            <th>importe</th>
                        </tr>
                    </thead>
                    <tbody class="invoice_tbody">
                       <tr t-foreach="o.move_lines" t-as="l">
                         <t t-set="idprod" t-value="l.product_id.id"/>

                              <td>
                                <span t-field="l.product_id.id"/>
                              </td>

                              <td t-att-colspan="2">
                                  <span t-field="l.product_id.name"/>
                              </td>

                              <td class="text-right">
                                  <span t-esc="int(l.product_uom_qty)"/>
                              </td>

                              <td class="text-right">
                                 <span t-esc="l.product_uom_qty*l.product_id.packaging_ids.qty"/>
                              </td>

                              <td class="text-right">
                                <t t-foreach="o.sale_id.order_line" t-as="ol">

                                  <t t-if="idprod == ol.product_id.id">
                                   
                                   <t t-if="ol.product_id.id == idprod">
                                            <t t-set="price" t-value="ol.price_unit"/>
                                            
                                            <t t-if="ol.discount1 >0">
                                              <t t-set="disc1" t-value="ol.discount1"/>
                                            </t>
                                            <t t-if="ol.discount2 >0">
                                              <t t-set="disc2" t-value="ol.discount2"/>
                                            </t>
                                            
                                            <t t-if="0>=disc1 and 0>=disc2">
                                              
                                              <span t-esc="price"></span>
                                            </t>

                                            <t t-if="disc1>0 and disc2 >0">
                                              <t t-set="pricedisc" t-value="price -(price*disc1/100)"/>
                                              <t t-set="pricedisc" t-value="pricedisc-(pricedisc*disc2/100)"/>

                                              <span t-esc="'%.2f'%pricedisc"></span>
                                            </t>

                                            <t t-if="disc1>0 and 0>=disc2">
                                              <t t-set="pricedisc" t-value="price-(price*disc1/100)"/>

                                              <span t-esc="'%.2f'%pricedisc"></span>
                                            </t>
                                            <t t-if="0>=disc1 and disc2>0">
                                              <t t-set="pricedisc" t-value="price-(price*disc2/100)"/>
                                              <span t-esc="'%.2f'%pricedisc"></span>
                                            </t>
                                                   
                                        </t> 




                                  </t>
                                </t>
                              </td>
                            
                        </tr>
                    </tbody>
                </table>

                <div class="row " style="margin-top:100px;">

                  <table class="table table-bordered" style="width:65%;float:right;">
                    <thead class="text-uppercase" style="background-color:gray;border:1px solid black">
                      <tr>
                        <td>Nombre repartidor</td>
                        <td>Situación</td>
                      </tr>
                    </thead>
                    <tbody>
                      <td><span t-field="o.carrier_id.name"></span></td>
                      <td><span t-field="o.state"></span></td>
                    </tbody>
                  </table>
                  <table class="table table-bordered">
                    <thead class="text-uppercase" style="background-color:gray;">
                      <th>total imp</th>
                      <th>%</th>
                      <th>importe</th>
                      <th>base</th>
                      <th>%</th>
                      <th>iva</th>
                      <th>%</th>
                      <th>rec</th>
                      <th>total (€)</th>
                    </thead>
                    <tbody class="text-right">

                          <t t-set="i" t-value="1"/>
                          <t t-foreach="o.taxes" t-as="p" >
                            <t t-set="i" t-value="i+1"/>
                          </t>
  
                      <t t-set="z" t-value="1"/>
                      
                      <t t-foreach="o.taxes" t-as="t">
                            

                        <t t-if="'Recargo Equivalencia' not in t.name ">
                          
                        <tr>
                        <t t-if="z == 1">
                        <td  t-att-rowspan="i"><span t-field="o.amount_untaxed"/></td>
                        </t>
                        <td></td>
                        <td></td>


                        <td>
                          <t t-if="'Recargo Equivalencia' not in t.name ">
                          <span t-field="t.base"/>
                          </t>
                        </td>

                        <t t-set="h" t-value="t.amount"/>
                        <t t-set="j" t-value="t.base"/>
                        <t t-set="k" t-value="h*100/j"/>

                        <td>
                           <t t-if="'Recargo Equivalencia' not in t.name ">
                            <span t-esc="round(k)"/>
                           </t>
                        </td>

                        <td>
                           <t t-if="'Recargo Equivalencia' not in t.name ">
                          <span t-field="t.amount"/>
                          </t>
                        </td>

                        <td>
                          <t t-if="'21% IVA' == t.name" >
                            <t t-foreach="o.taxes" t-as="b">
                                <t t-if="'5.2% Recargo Equivalencia Ventas' == b.name ">
                                 <span>5,2</span>
                           </t>
                          </t>
                        </t>
                          <t t-if="'10% IVA' == t.name" >
                            <t t-foreach="o.taxes" t-as="b">
                                <t t-if="'1.4% Recargo Equivalencia Ventas' == b.name ">
                                 <span>1,4</span>
                           </t>
                          </t>
                        </t>
                          <t t-if="'4% IVA' == t.name" >
                            <t t-foreach="o.taxes" t-as="b">
                                <t t-if="'0.50% Recargo Equivalencia Ventas' == b.name ">
                                  <span>0,5</span>
                           </t>
                          </t>
                        </t>

                        </td>
                        
                          <td>
                            <t t-if="'21% IVA' == t.name">
                            <t t-foreach="o.taxes" t-as="b">
                                <t t-if="'5.2% Recargo Equivalencia Ventas' == b.name ">
                                  <span t-field="b.amount"/>
                             </t>
                           </t>
                          </t>
                          <t t-if="'10% IVA' == t.name">
                            <t t-foreach="o.taxes" t-as="b">
                                <t t-if="'1.4% Recargo Equivalencia Ventas' == b.name ">                      
                                  <span t-field="b.amount"/>
                             </t>
                           </t>
                          </t>
                          <t t-if="'4% IVA' == t.name">
                            <t t-foreach="o.taxes" t-as="b">
                                <t t-if="'0.50% Recargo Equivalencia Ventas' == b.name ">                           
                                  <span t-field="b.amount"/>
                             </t>
                           </t>
                          </t>
                          </td>
                        
                        
                        <t t-if="z == 1">
                        <td  t-att-rowspan="i"><span t-field="o.amount_total"/></td>
                        </t>
                        <t t-set="z" t-value="z+1"/>
                      </tr>

                      
                    </t>
                    </t>
                    
                    </tbody>
                  </table>
              </div>
              </div>
           </div>
      </t>
            <!--end of report structure-->
        </template>

<!--####################################################################################################-->

        <template id="liderit_hielos_picking_report">
            <t t-call="report.html_container">
                <t t-foreach="docs" t-as="o">

                    <t t-call="liderit_hielos_reports.liderit_hielos_picking_report_document" t-lang="o.partner_id.lang"/>
                </t>
   
            </t>
        </template>






    <!-- ############################## cuerpo Albaran EUROPASTRY ##################################-->
        
        <template id="liderit_hielos_picking_europastry_report_document">
          <t t-call="liderit_hielos_reports.external_layout_albaranes_hielos">

          <div class="page" style="font-size:11px !important;">
            <div class="oe_structure">
             
                
                <table class="table table-condensed" style="">
                    <thead class="text-uppercase" style="background-color:gray;border:1px solid black">
                        <tr>
                            <th>código</th>
                            <th t-att-colspan="2">descripción</th>
                            <th>cajas</th>
                            <th>unidades</th>
                            <th>precio</th>
                            <th>importe</th>
                        </tr>
                    </thead>
                    <tbody class="invoice_tbody">
                       <tr t-foreach="o.sale_id.order_line" t-as="l">
                            <td><span t-field="l.product_id"/></td>
                           <td t-att-colspan="2">
                                <span t-field="l.name"/>
                            </td>
                            <td class="text-right">
                                <span t-esc="int(l.product_uom_qty)"/>
                            </td>
                            <td class="text-right">
                               <span t-esc="l.product_uom_qty*l.product_id.packaging_ids.qty"/>
                            </td>
                            <td class="text-right"><span t-esc="l.price_subtotal"/></td>
                            
                        </tr>
                    </tbody>
                </table>
                

                <div class="row " style="margin-top:100px;">

                 <p class="text-center" style="font-size:1.5em;letter-spacing: 1px;">Mercancía entregada por orden de EUROPASTRY, S.A. A-58695032</p>
                  <table class="table table-bordered">
                    <thead class="text-uppercase" style="background-color:gray;">
                      <th>total imp</th>
                      <th>%</th>
                      <th>importe</th>
                      <th>base</th>
                      <th>%</th>
                      <th>iva</th>
                      <th>%</th>
                      <th>rec</th>
                      <th>total (€)</th>
                    </thead>
                    <tbody class="text-left">
                      <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                      </tr>
                    </tbody>
                  </table>
              </div>
              </div>
           </div>
      </t>
            <!--end of report structure-->
        </template>

<!--####################################################################################################-->

  <template id="liderit_hielos_picking_europastry_report">
            <t t-call="report.html_container">
                <t t-foreach="docs" t-as="o">

                    <t t-call="liderit_hielos_reports.liderit_hielos_picking_europastry_report_document" t-lang="o.partner_id.lang"/>
                </t>
   
            </t>
        </template>
    </data>
</openerp>



